---
#
# XBMC install
#
- name: Install add-apt-repository
  apt: pkg=python-software-properties state=installed
    
- name: Add multimedia testing repository
  apt_repository: repo='deb http://www.deb-multimedia.org testing main non-free'
  when_string: $ansible_distribution == "Debian"

- name: Install latest xbmc
  apt: pkg=xbmc state=installed force=yes update_cache=yes 

#
# Install PVR backend (mythtv)
#

# Issue: Still asks for password (Have sent an email to MLUG 10/05/13)
# echo -e '\n' | sudo DEBIAN_FRONTEND=noninteractive DEBIAN_PRIORITY=critical /usr/bin/apt-get --option Dpkg::Options::=--force-confold -q -y --force-yes install 'mythtv-backend'
# 
# As a workaround to this issue I copy over a script which uses 'expect' and answers the question automatically.

- name: Copy over script to run
  copy: src=common/files/install_mythtv-backend.sh dest=/tmp mode=0550

- name: Install Mythtv-backend
  action: command /tmp/install_mythtv-backend.sh creates=/usr/bin/mythbackend
